{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport \"core-js/modules/esnext.iterator.map.js\";\nimport { defineComponent, ref, onMounted, watch } from \"vue\";\nimport { getTramSorted, searchCriteria } from \"@/api/tram\";\nexport default defineComponent({\n  setup() {\n    // 查询参数\n    const queryParam = ref({\n      selectedOption: \"\" // 默认选项为空\n    });\n    watch(() => queryParam.value, newValue => {\n      console.log(\"selectedOption has changed:\", newValue); // 调试打印\n    });\n\n    // 表格数据\n    const data = ref([]);\n\n    // 分页参数\n    const current = ref(1);\n    const pageSize = ref(10);\n    const totalItems = ref(0);\n\n    // 处理查询\n    const handleSearch = async () => {\n      try {\n        console.log(queryParam.value); // 打印选中的查询条件\n        const response = await searchCriteria(queryParam.value);\n        if (response.data.code === 0) {\n          const formattedData = response.data.data.map(item => ({\n            ...item,\n            tags: item.tags.split(\";\").map(tag => tag.trim()).filter((tag, index, self) => self.indexOf(tag) === index)\n          }));\n          data.value = formattedData;\n        }\n      } catch (error) {\n        console.error(\"Error searching shops:\", error);\n      }\n    };\n\n    // 默认加载排序后的数据\n    onMounted(async () => {\n      try {\n        const response = await getTramSorted();\n        console.log(response.data.data);\n        if (response.data.code === 0) {\n          const formattedData = response.data.data.map(item => ({\n            ...item,\n            tags: item.tags ? item.tags.split(\";\").map(tag => tag.trim()).filter((tag, index, self) => self.indexOf(tag) === index) : [] // 如果没有 tags 字段，设置为空数组\n          }));\n          data.value = formattedData;\n        }\n      } catch (error) {\n        console.error(\"Error fetching shops:\", error);\n      }\n    });\n\n    // 监听 selectedOption 变化，调试用\n    watch(() => queryParam.value.selectedOption, (newValue, oldValue) => {\n      console.log(`selectedOption changed from ${oldValue} to ${newValue}`);\n    });\n    const columns = [{\n      title: \"编号\",\n      dataIndex: \"id\",\n      key: \"id\" // 唯一标识\n    }, {\n      title: \"当前车辆所属停车点\",\n      dataIndex: \"current_location\",\n      key: \"current_location\" // 唯一标识\n    }, {\n      title: \"当前车辆所属状态\",\n      dataIndex: \"status\",\n      key: \"status\" // 唯一标识\n    }, {\n      title: \"当前自行车剩余电量\",\n      dataIndex: \"remaining_battery\",\n      key: \"remaining_battery\",\n      // 唯一标识\n      defaultSortOrder: \"descend\",\n      sorter: (a, b) => a.age - b.age\n    }];\n    return {\n      queryParam,\n      data,\n      columns,\n      current,\n      pageSize,\n      totalItems,\n      handleSearch\n    };\n  }\n});","map":{"version":3,"names":["defineComponent","ref","onMounted","watch","getTramSorted","searchCriteria","setup","queryParam","selectedOption","value","newValue","console","log","data","current","pageSize","totalItems","handleSearch","response","code","formattedData","map","item","tags","split","tag","trim","filter","index","self","indexOf","error","oldValue","columns","title","dataIndex","key","defaultSortOrder","sorter","a","b","age"],"sources":["E:\\code\\Django\\project\\front\\front\\src\\components\\Data_Sheet.vue"],"sourcesContent":["<template>\r\n  <a-card>\r\n    <a-form layout=\"inline\">\r\n      <a-form-item label=\"选择条件\" class=\"form-item\">\r\n        <a-select\r\n          v-model=\"queryParam.selectedOption\"\r\n          placeholder=\"请选择\"\r\n          class=\"form-item-button-one\"\r\n        >\r\n          <a-select-option value=\"normal\">正常</a-select-option>\r\n          <a-select-option value=\"Low_battery\">低电量(低于20%)</a-select-option>\r\n          <a-select-option value=\"maintenance\">待维护</a-select-option>\r\n        </a-select>\r\n      </a-form-item>\r\n      <a-form-item>\r\n        <a-button\r\n          type=\"primary\"\r\n          @click=\"handleSearch\"\r\n          class=\"form-item-button-tow\"\r\n          >查询</a-button\r\n        >\r\n      </a-form-item>\r\n    </a-form>\r\n  </a-card>\r\n\r\n  <a-table\r\n    :columns=\"columns\"\r\n    :data-source=\"data\"\r\n    :row-key=\"(record) => record.id\"\r\n    :pagination=\"false\"\r\n  >\r\n    <template v-slot:bodyCell=\"{ column, record }\">\r\n      <template v-if=\"column.key === 'name'\">\r\n        <a>\r\n          {{ record.name }}\r\n        </a>\r\n      </template>\r\n      <template v-else-if=\"column.key === 'tags'\">\r\n        <span>\r\n          <a-tag\r\n            v-for=\"tag in record.tags\"\r\n            :key=\"tag\"\r\n            :color=\"\r\n              tag === 'loser'\r\n                ? 'volcano'\r\n                : tag.length > 5\r\n                ? 'geekblue'\r\n                : 'green'\r\n            \"\r\n          >\r\n            {{ tag.toUpperCase() }}\r\n          </a-tag>\r\n        </span>\r\n      </template>\r\n      <template v-else-if=\"column.key === 'rate'\">\r\n        <a-rate :value=\"record.rating\" disabled allow-half />\r\n      </template>\r\n    </template>\r\n  </a-table>\r\n\r\n  <a-layout-Footer>\r\n    <a-pagination\r\n      v-model=\"current\"\r\n      :total=\"totalItems\"\r\n      :page-size=\"pageSize\"\r\n      @change=\"handlePageChange\"\r\n      show-size-changer\r\n      show-less-items\r\n    />\r\n  </a-layout-Footer>\r\n</template>\r\n\r\n<script>\r\nimport { defineComponent, ref, onMounted, watch } from \"vue\";\r\nimport { getTramSorted, searchCriteria } from \"@/api/tram\";\r\n\r\nexport default defineComponent({\r\n  setup() {\r\n    // 查询参数\r\n    const queryParam = ref({\r\n      selectedOption: \"\", // 默认选项为空\r\n    });\r\n\r\n    watch(\r\n      () => queryParam.value,\r\n      (newValue) => {\r\n        console.log(\"selectedOption has changed:\", newValue); // 调试打印\r\n      }\r\n    );\r\n\r\n    // 表格数据\r\n    const data = ref([]);\r\n\r\n    // 分页参数\r\n    const current = ref(1);\r\n    const pageSize = ref(10);\r\n    const totalItems = ref(0);\r\n\r\n    // 处理查询\r\n    const handleSearch = async () => {\r\n      try {\r\n        console.log(queryParam.value); // 打印选中的查询条件\r\n        const response = await searchCriteria(queryParam.value);\r\n        if (response.data.code === 0) {\r\n          const formattedData = response.data.data.map((item) => ({\r\n            ...item,\r\n            tags: item.tags\r\n              .split(\";\")\r\n              .map((tag) => tag.trim())\r\n              .filter((tag, index, self) => self.indexOf(tag) === index),\r\n          }));\r\n          data.value = formattedData;\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error searching shops:\", error);\r\n      }\r\n    };\r\n\r\n    // 默认加载排序后的数据\r\n    onMounted(async () => {\r\n      try {\r\n        const response = await getTramSorted();\r\n        console.log(response.data.data);\r\n        if (response.data.code === 0) {\r\n          const formattedData = response.data.data.map((item) => ({\r\n            ...item,\r\n            tags: item.tags\r\n              ? item.tags\r\n                  .split(\";\")\r\n                  .map((tag) => tag.trim())\r\n                  .filter((tag, index, self) => self.indexOf(tag) === index)\r\n              : [], // 如果没有 tags 字段，设置为空数组\r\n          }));\r\n          data.value = formattedData;\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching shops:\", error);\r\n      }\r\n    });\r\n\r\n    // 监听 selectedOption 变化，调试用\r\n    watch(\r\n      () => queryParam.value.selectedOption,\r\n      (newValue, oldValue) => {\r\n        console.log(`selectedOption changed from ${oldValue} to ${newValue}`);\r\n      }\r\n    );\r\n\r\n    const columns = [\r\n      {\r\n        title: \"编号\",\r\n        dataIndex: \"id\",\r\n        key: \"id\", // 唯一标识\r\n      },\r\n      {\r\n        title: \"当前车辆所属停车点\",\r\n        dataIndex: \"current_location\",\r\n        key: \"current_location\", // 唯一标识\r\n      },\r\n      {\r\n        title: \"当前车辆所属状态\",\r\n        dataIndex: \"status\",\r\n        key: \"status\", // 唯一标识\r\n      },\r\n      {\r\n        title: \"当前自行车剩余电量\",\r\n        dataIndex: \"remaining_battery\",\r\n        key: \"remaining_battery\", // 唯一标识\r\n        defaultSortOrder: \"descend\",\r\n        sorter: (a, b) => a.age - b.age,\r\n      },\r\n    ];\r\n\r\n    return {\r\n      queryParam,\r\n      data,\r\n      columns,\r\n      current,\r\n      pageSize,\r\n      totalItems,\r\n      handleSearch,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style></style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}