{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache) {\n  const _component_a_input = _resolveComponent(\"a-input\");\n  const _component_a_form_item = _resolveComponent(\"a-form-item\");\n  const _component_a_input_password = _resolveComponent(\"a-input-password\");\n  const _component_a_button = _resolveComponent(\"a-button\");\n  const _component_a_form = _resolveComponent(\"a-form\");\n  const _component_a_card = _resolveComponent(\"a-card\");\n  const _component_a_layout_content = _resolveComponent(\"a-layout-content\");\n  const _component_a_layout = _resolveComponent(\"a-layout\");\n  return _openBlock(), _createBlock(_component_a_layout, {\n    class: \"layout\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_a_layout_content, {\n      style: {\n        \"padding\": \"24px\"\n      }\n    }, {\n      default: _withCtx(() => [_createVNode(_component_a_card, {\n        title: \"新用户注册\",\n        bordered: false\n      }, {\n        default: _withCtx(() => [_createVNode(_component_a_form, {\n          model: _ctx.registerForm,\n          rules: _ctx.rules,\n          onFinish: _ctx.logins\n        }, {\n          default: _withCtx(() => [_createVNode(_component_a_form_item, {\n            name: \"username\",\n            label: \"新用户名\",\n            labelCol: {\n              span: 24\n            },\n            wrapperCol: {\n              span: 24\n            },\n            hasFeedback: \"\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_input, {\n              value: _ctx.registerForm.username,\n              \"onUpdate:value\": _cache[0] || (_cache[0] = $event => _ctx.registerForm.username = $event)\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_a_form_item, {\n            name: \"password\",\n            label: \"密码\",\n            labelCol: {\n              span: 24\n            },\n            wrapperCol: {\n              span: 24\n            },\n            hasFeedback: \"\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_input_password, {\n              value: _ctx.registerForm.password,\n              \"onUpdate:value\": _cache[1] || (_cache[1] = $event => _ctx.registerForm.password = $event)\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_a_form_item, {\n            name: \"confirm\",\n            label: \"确认密码\",\n            labelCol: {\n              span: 24\n            },\n            wrapperCol: {\n              span: 24\n            },\n            hasFeedback: \"\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_input_password, {\n              value: _ctx.registerForm.confirm,\n              \"onUpdate:value\": _cache[2] || (_cache[2] = $event => _ctx.registerForm.confirm = $event)\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_a_form_item, {\n            name: \"employeeKey\",\n            label: \"员工密钥（可选）\",\n            labelCol: {\n              span: 24\n            },\n            wrapperCol: {\n              span: 24\n            }\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_input, {\n              value: _ctx.registerForm.employeeKey,\n              \"onUpdate:value\": _cache[3] || (_cache[3] = $event => _ctx.registerForm.employeeKey = $event)\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_a_form_item, {\n            name: \"phone\",\n            label: \"手机号（可选）\",\n            labelCol: {\n              span: 24\n            },\n            wrapperCol: {\n              span: 24\n            }\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_input, {\n              value: _ctx.registerForm.phone,\n              \"onUpdate:value\": _cache[4] || (_cache[4] = $event => _ctx.registerForm.phone = $event)\n            }, null, 8 /* PROPS */, [\"value\"])]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_a_form_item, {\n            wrapperCol: {\n              span: 24,\n              offset: 0\n            }\n          }, {\n            default: _withCtx(() => [_createVNode(_component_a_button, {\n              type: \"primary\",\n              htmlType: \"submit\"\n            }, {\n              default: _withCtx(() => _cache[5] || (_cache[5] = [_createTextVNode(\"提交注册\")])),\n              _: 1 /* STABLE */\n            }), _createVNode(_component_a_button, {\n              style: {\n                \"margin-left\": \"8px\"\n              },\n              onClick: _ctx.handleCancel\n            }, {\n              default: _withCtx(() => _cache[6] || (_cache[6] = [_createTextVNode(\"取消注册\")])),\n              _: 1 /* STABLE */\n            }, 8 /* PROPS */, [\"onClick\"])]),\n            _: 1 /* STABLE */\n          })]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"model\", \"rules\", \"onFinish\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["_createBlock","_component_a_layout","class","default","_withCtx","_createVNode","_component_a_layout_content","style","_component_a_card","title","bordered","_component_a_form","model","_ctx","registerForm","rules","onFinish","logins","_component_a_form_item","name","label","labelCol","span","wrapperCol","hasFeedback","_component_a_input","value","username","_cache","$event","_","_component_a_input_password","password","confirm","employeeKey","phone","offset","_component_a_button","type","htmlType","_createTextVNode","onClick","handleCancel"],"sources":["E:\\code\\Django\\project\\front\\front\\src\\components\\EnrollWindow.vue"],"sourcesContent":["<template>\r\n  <a-layout class=\"layout\">\r\n    <a-layout-content style=\"padding: 24px\">\r\n      <a-card title=\"新用户注册\" :bordered=\"false\">\r\n        <a-form :model=\"registerForm\" :rules=\"rules\" @finish=\"logins\">\r\n          <a-form-item\r\n            name=\"username\"\r\n            label=\"新用户名\"\r\n            :labelCol=\"{ span: 24 }\"\r\n            :wrapperCol=\"{ span: 24 }\"\r\n            hasFeedback\r\n          >\r\n            <a-input v-model:value=\"registerForm.username\" />\r\n          </a-form-item>\r\n          <a-form-item\r\n            name=\"password\"\r\n            label=\"密码\"\r\n            :labelCol=\"{ span: 24 }\"\r\n            :wrapperCol=\"{ span: 24 }\"\r\n            hasFeedback\r\n          >\r\n            <a-input-password v-model:value=\"registerForm.password\" />\r\n          </a-form-item>\r\n          <a-form-item\r\n            name=\"confirm\"\r\n            label=\"确认密码\"\r\n            :labelCol=\"{ span: 24 }\"\r\n            :wrapperCol=\"{ span: 24 }\"\r\n            hasFeedback\r\n          >\r\n            <a-input-password v-model:value=\"registerForm.confirm\" />\r\n          </a-form-item>\r\n          <a-form-item\r\n            name=\"employeeKey\"\r\n            label=\"员工密钥（可选）\"\r\n            :labelCol=\"{ span: 24 }\"\r\n            :wrapperCol=\"{ span: 24 }\"\r\n          >\r\n            <a-input v-model:value=\"registerForm.employeeKey\" />\r\n          </a-form-item>\r\n          <a-form-item\r\n            name=\"phone\"\r\n            label=\"手机号（可选）\"\r\n            :labelCol=\"{ span: 24 }\"\r\n            :wrapperCol=\"{ span: 24 }\"\r\n          >\r\n            <a-input v-model:value=\"registerForm.phone\" />\r\n          </a-form-item>\r\n          <a-form-item :wrapperCol=\"{ span: 24, offset: 0 }\">\r\n            <a-button type=\"primary\" htmlType=\"submit\">提交注册</a-button>\r\n            <a-button style=\"margin-left: 8px\" @click=\"handleCancel\"\r\n              >取消注册</a-button\r\n            >\r\n          </a-form-item>\r\n        </a-form>\r\n      </a-card>\r\n    </a-layout-content>\r\n  </a-layout>\r\n</template>\r\n\r\n<script>\r\nimport { reactive } from \"vue\";\r\nimport { useAuthStore } from \"@/storage/userStorage\";\r\nimport { useRouter } from \"vue-router\";\r\nimport {\r\n  Form,\r\n  Input,\r\n  Button,\r\n  Card,\r\n  Layout,\r\n  InputPassword,\r\n  message,\r\n} from \"ant-design-vue\";\r\n\r\nexport default {\r\n  components: {\r\n    \"a-layout\": Layout,\r\n    \"a-layout-content\": Layout.Content,\r\n    \"a-card\": Card,\r\n    \"a-form-item\": Form.Item,\r\n    \"a-input\": Input,\r\n    \"a-input-password\": InputPassword,\r\n    \"a-button\": Button,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      registerForm: reactive({\r\n        username: \"\",\r\n        password: \"\",\r\n        confirm: \"\",\r\n        employeeKey: \"\",\r\n        phone: \"\",\r\n      }),\r\n      rules: {\r\n        username: [\r\n          {\r\n            required: false,\r\n            message: \"请输入正确的用户名\",\r\n            trigger: /^\\S{4,10}$/,\r\n          },\r\n        ],\r\n        password: [\r\n          {\r\n            required: false,\r\n            message: \"请输入正确的密码\",\r\n            pattern: /^\\S{8,16}$/,\r\n          },\r\n        ],\r\n        confirm: [\r\n          { required: false, message: \"请确认密码\", trigger: \"blur\" },\r\n          {\r\n            validator: (_, value) => {\r\n              // 使用箭头函数来捕获外围作用域中的 this\r\n              if (!value || value === this.registerForm.password) {\r\n                return Promise.resolve();\r\n              }\r\n              return Promise.reject(new Error(\"两次输入的密码不一致\"));\r\n            },\r\n          },\r\n        ],\r\n        employeeKey: [{ required: false }],\r\n        phone: [\r\n          {\r\n            required: false,\r\n            pattern: /^\\S{11,11}$/,\r\n            message: \"请输入正确的手机号\",\r\n          },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n\r\n  setup() {\r\n    const router = useRouter();\r\n    const authStore = useAuthStore();\r\n\r\n    const logins = async () => {\r\n      console.log(\"staff_username:\", values.username);\r\n      console.log(\"staff_password:\", values.password);\r\n      console.log(\"staff_phone:\", values.phone);\r\n      try {\r\n        await authStore.register({\r\n            staff_username: values.username, // 使用后端需要的字段名\r\n            staff_password: values.password,\r\n            staff_telephone: values.phone || null, // 可选字段\r\n          });\r\n          message.success(\"注册成功\");\r\n          await router.push({ path: \"/\" }); // 注册成功后跳转到登录页面\r\n        } catch (error) {\r\n          message.error(\"注册失败\");\r\n      }\r\n    };\r\n    handleCancel() {\r\n      this.$router.push(\"/\");\r\n      this.isModalVisible = false;\r\n    } // 关闭模态框\r\n    return{ logins,handleCancel }\r\n  }\r\n\r\n  // methods: {\r\n    // async logins() {\r\n    //   await this.handleSubmit(this.registerForm);\r\n    // },\r\n    // async handleSubmit(values) {\r\n    //   const router = useRouter();\r\n    //   const authStore = useAuthStore();\r\n    //   console.log(\"staff_username:\", values.username);\r\n    //   console.log(\"staff_password:\", values.password);\r\n    //   console.log(\"staff_phone:\", values.phone);\r\n    //   try {\r\n    //     await authStore.register({\r\n    //       staff_username: values.username, // 使用后端需要的字段名\r\n    //       staff_password: values.password,\r\n    //       staff_telephone: values.phone || null, // 可选字段\r\n    //     });\r\n    //     message.success(\"注册成功\");\r\n    //     console.log(\"one\", router);\r\n    //     await router.push(\"/\"); // 注册成功后跳转到登录页面\r\n    //   } catch (error) {\r\n    //     message.error(\"用户名或手机号重复!\");\r\n    //   }\r\n    // },\r\n    // handleCancel() {\r\n    //   this.$router.push(\"/\");\r\n    //   this.isModalVisible = false; // 关闭模态框\r\n    // },\r\n  // },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.layout {\r\n  height: 100vh;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}